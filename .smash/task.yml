##################################################################
# samsh-cli
##################################################################
smash-cli-install:
  - name: smash-middleware-shell
    commands:
      - npm i -g yarn yrm nrm --registry=https://registry.npm.taobao.org
      - nrm use taobao
      - yrm use taobao
      - yarn install
      # Allow husky to be used within the scripts of the root package.json
      # https://yarnpkg.com/en/docs/cli/add#toc-yarn-add-ignore-workspace-root-check-w
      - yarn add husky --dev -W

test-main-and-helper:
  - name: smash-middleware-shell
    commands:
      - node scripts/test-main.js

test-smash-cli:
  - name: smash-middleware-shell
    commands:
      - node scripts/test-main.js --package=packagesMain/smash-cli

##################################################################
# docusaurus
##################################################################
# docusaurus: install dependencies
docusaurus-install:
  - name: smash-middleware-shell
    commands:
      - cd docusaurus/website
      - yarn install
# docusaurus: start local web-server
docusaurus-start:
  - name: smash-middleware-shell
    commands:
      - cd docusaurus/website
      - yarn start
# docusaurus: build static files
docusaurus-build:
  - name: smash-middleware-shell
    commands:
      - cd docusaurus/website
      - yarn build
# publish docusaurus to gh-pages
docusaurus-gh-pages:
  - name: smash-middleware-shell
    commands:
      - cd docusaurus/website
      - npx cross-env GIT_USER=chenhaihong CURRENT_BRANCH=master npm run publish-gh-pages

##################################################################
# lerna
##################################################################
# 使用lerna发布
lerna-publish:
  - name: smash-middleware-shell
    commands:
      - nrm use npm
      - lerna publish
      - nrm use taobao
# 示例：使用lerna创建子包
lerna-create:
  - name: smash-middleware-shell
    commands:
      # 在packagesHelper目录下创建子包
      - lerna create smash-helper-logger packagesHelper
# 示例：使用lerna一次性添加多个依赖
lerna-add:
  - name: smash-middleware-shell
    commands:
      # - lerna add fs-extra # 为所有包，添加fs-extra依赖
      # - lerna add webpack --scope=smash-helper-babel-preset-react --dev # 为指定的包添加依赖添加dev依赖
      # - lerna add @babel/preset-env --scope=smash-helper-babel-preset-react # 为指定的包添加依赖添加依赖
